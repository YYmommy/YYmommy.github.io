<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>SQL 学习笔记 - Jianbo Wang | 王健波</title>
    <meta property="og:title" content="SQL 学习笔记 - Jianbo Wang | 王健波">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="2020年1月13日学習内容 关系数据库概述 - 廖雪峰的官方网站
[&amp;hellip;] 从 MySQL 官方网站下载最新的 MySQL Community Server 版本： https://dev.mysql.com/downloads/mysql/
[&amp;hellip;] Mac：
cd /usr/local/mysql/bin ./mysql -u root -p mysql的可执行命令 &amp;hellip;">
      <meta property="og:description" content="2020年1月13日学習内容 关系数据库概述 - 廖雪峰的官方网站
[&amp;hellip;] 从 MySQL 官方网站下载最新的 MySQL Community Server 版本： https://dev.mysql.com/downloads/mysql/
[&amp;hellip;] Mac：
cd /usr/local/mysql/bin ./mysql -u root -p mysql的可执行命令 &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<script async src="/js/load-typekit.js"></script>


<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.png" alt="Jianbo Wang" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/cn/translation/">翻译</a></li>
  
  <li><a href="/cn/issues/">日志</a></li>
  
  <li><a href="/tags/">标签</a></li>
  
  <li><a href="/cn/about/">关于</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>SQL 学习笔记</h1>

<h3>
  2020-01-13</h3>
<hr>


      </header>





<p>2020年1月13日学習内容
<a href="https://www.liaoxuefeng.com/wiki/1177760294764384/1179613436834240">关系数据库概述 - 廖雪峰的官方网站</a></p>
<h2 id="安装-mysql">安装 mySQL</h2>
<p>从 MySQL 官方网站下载最新的 MySQL Community Server 版本：
<a href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a></p>
<h2 id="运行-mysql">运行 MySQL</h2>
<p>Mac：</p>
<pre tabindex="0"><code>cd /usr/local/mysql/bin
./mysql -u root -p
</code></pre><p>mysql的可执行命令在/usr/local/mysql/bin目录下，而这个目录不在普通用户的环境路径下，因此每次执行时都需要输入完整路径，比较麻烦。因此需要将这个路径添加到环境变量中。首先我们需要创建一个 .bash_profile 文件（不要掉了文件名前面的 . 号），命令如下：</p>
<pre tabindex="0"><code>touch .bash_profile
</code></pre><p>创建完成后，用编辑器打开这个文件，添加下面的内容：</p>
<pre tabindex="0"><code>export PATH=/usr/local/mysql/bin:$PATH
</code></pre><p>保存后退出</p>
<h2 id="准备数据">准备数据</h2>
<p>下载 <a href="https://raw.githubusercontent.com/michaelliao/learn-sql/master/mysql/init-test-data.sql">SQL 脚本</a>，在命令行运行：</p>
<pre tabindex="0"><code>$ mysql -u root -p &lt; init-test-data.sql
</code></pre><p>就可以自动创建 test 数据库，并且在 test 数据库下创建 students 表和
classes 表，以及必要的初始化数据。</p>
<h2 id="使用数据库">使用数据库</h2>
<pre tabindex="0"><code>mysql&gt; USE test;
</code></pre><h2 id="基本查询">基本查询</h2>
<pre tabindex="0"><code>SELECT * FROM &lt;表名&gt;
</code></pre><h2 id="条件查询">条件查询</h2>
<pre tabindex="0"><code>SELECT * FROM &lt;表名&gt; WHERE &lt;条件表达式&gt;
SELECT * FROM &lt;表名&gt; WHERE &lt;条件1&gt; AND/OR &lt;条件2&gt;
SELECT * FROM &lt;表名&gt; WHERE NOT &lt;条件&gt;
SELECT * FROM &lt;表名&gt; WHERE score BETWEEN 60 AND 90
</code></pre><p>要组合三个或者更多的条件，就需要用小括号()表示如何进行条件运算。
如果不加括号，条件运算按照 NOT、AND、OR 的优先级进行。</p>
<h2 id="投影查询">投影查询</h2>
<pre tabindex="0"><code>SELECT 列1, 列2, 列3 FROM …
SELECT 列1 别名1, 列2 别名2, 列3 别名3 FROM …
</code></pre><h2 id="排序">排序</h2>
<pre tabindex="0"><code>SELECT id, name, gender, score FROM students ORDER BY score (DESC);
</code></pre><h2 id="分页查询">分页查询</h2>
<pre tabindex="0"><code>LIMIT &lt;M&gt; OFFSET &lt;N&gt;
</code></pre><p>在 MySQL 中，</p>
<pre tabindex="0"><code>LIMIT 15 OFFSET 30
</code></pre><p>还可以简写成</p>
<pre tabindex="0"><code>LIMIT 30, 15
</code></pre><h2 id="聚合查询">聚合查询</h2>
<pre tabindex="0"><code>SELECT COUNT(*) num FROM &lt;表名&gt;
</code></pre><p>除了 COUNT() 函数外，SQL 还提供了如下聚合函数：</p>
<ul>
<li>SUM
计算某一列的合计值，该列必须为数值类型</li>
<li>AVG
计算某一列的平均值，该列必须为数值类型</li>
<li>MAX
计算某一列的最大值</li>
<li>MIN
计算某一列的最小值</li>
</ul>
<p>通过聚合查询获得总页数：</p>
<pre tabindex="0"><code> SELECT CEILING(COUNT(*) / 3) FROM students;
</code></pre><h3 id="分组">分组</h3>
<pre tabindex="0"><code>SELECT class_id, COUNT(*) num FROM students GROUP BY class_id;
SELECT class_id, gender, COUNT(*) num FROM students GROUP BY class_id, gender;
</code></pre><h2 id="多表查询">多表查询</h2>
<pre tabindex="0"><code>SELECT
    s.id sid,
    s.name,
    s.gender,
    s.score,
    c.id cid,
    c.name cname
FROM students s, classes c
WHERE s.gender = 'M' AND c.id = 1;
</code></pre><h2 id="连接查询">连接查询</h2>
<pre tabindex="0"><code>SELECT s.id, s.name, s.class_id, c.name class_name, s.gender, s.score
FROM students s
INNER JOIN classes c
ON s.class_id = c.id;
</code></pre><p>注意 INNER JOIN 查询的写法是：</p>
<ul>
<li>先确定主表，仍然使用 FROM &lt;表1&gt; 的语法；</li>
<li>再确定需要连接的表，使用 INNER JOIN &lt;表2&gt; 的语法；</li>
<li>然后确定连接条件，使用 ON &lt;条件…&gt;，这里的条件是 s.class_id = c.id，表示 students 表的 class_id 列与 classes 表的 id 列相同的行需要连接；</li>
<li>可选：加上 WHERE 子句、ORDER BY 等子句。</li>
</ul>
<p>INNER JOIN、RIGHT OUTER JOIN、LEFT OUTER JOIN、FULL OUTER JOIN 的区别：</p>
<ul>
<li>INNER JOIN 只返回同时存在于两张表的行数据，由于 students 表的 class_id 包含 1，2，3，classes 表的 id 包含 1，2，3，4，所以，INNER JOIN 根据条件 s.class_id = c.id 返回的结果集仅包含 1，2，3。</li>
<li>RIGHT OUTER JOIN 返回右表都存在的行。如果某一行仅在右表存在，那么结果集就会以 NULL 填充剩下的字段。</li>
<li>LEFT OUTER JOIN 则返回左表都存在的行。</li>
<li>FULL OUTER JOIN 会把两张表的所有记录全部选择出来，并且，自动把对方不存在的列填充为 NULL。</li>
</ul>
<hr>
<p>参考：
<a href="https://jingyan.baidu.com/article/fa4125ac0e3c2928ac709204.html">如何在 Macbook 上安装 MySQL-百度经验</a>
<a href="https://stackoverflow.com/questions/51819285/bash-profile-bad-assignment">bash - .bash_profile: bad assignment - Stack Overflow</a></p>



  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/cn/issues/20190223/">N2备考建议</a></span>
  <span class="nav-next"><a href="/cn/issues/startbloggingwithhexoandgithub/">Hexo&#43;Github 搭建博客（Mac）</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/issues\/20190223\/';
    
  } else if (e.which == 39) {  
    
    url = '\/cn\/issues\/startbloggingwithhexoandgithub\/';
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
  <div class="tabs" style="display: none;">
  <input name="tabs" type="radio" id="tab-1" checked class="input"/>
  <label for="tab-1" class="label">Disqus</label>
  <div class="panel">
    <div id="disqus_thread"></div>
    <script data-src="//wjianbo.disqus.com/embed.js" async></script>
  </div>
  <input name="tabs" type="radio" id="tab-2" class="input"/>
  <label for="tab-2" class="label">Utterances</label>
  <div class="panel">
    <script data-src="https://utteranc.es/client.js" repo="wjianbo/wjianbo.github.io" issue-term="pathname"
      label="comment" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  <input name="tabs" type="radio" id="tab-3" class="input"/>
  <label for="tab-3" class="label">Preferences</label>
  <div class="panel">
    <p class="title">Layout of comment panels</p>
    <input name="layout" type="radio" id="layout-1" checked />
    <label for="layout-1">Tabbed (wide screen) / Stacked (small screen)</label>
    <br/>
    <input name="layout" type="radio" id="layout-2" />
    <label for="layout-2">Full display</label>
  </div>
  </div>
  <script>
  (function(d) {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var t = d.getElementById('disqus_thread'), s = t.nextElementSibling,
        a = d.querySelector('section.comments'),
        rads = a.querySelectorAll('input[type="radio"]');
    s.setAttribute('data-timestamp', +new Date());
    var inputValues = function() {
      var v = {};
      rads.forEach(function(el) { v[el.id] = el.checked; });
      return v;
    }, selectTab2 = function() {
      a.querySelector('#tab-2').checked = true;
      return 'add';
    }, showFullComment = function(el) {
      if (el.name !== 'layout') return;
      a.classList[el.id === 'layout-2' ? selectTab2() : 'remove']('comment-full');
    }, inputRestore = function() {
      var v = localStorage.getItem('comment-prefs');
      if (!v) return;
      v = JSON.parse(v);
      rads.forEach(function(el) {
        if (v[el.id]) {
          el.checked = true;
          showFullComment(el);
        }
      });
    }, inputSave = function() {
      showFullComment(this);
      loadScript();
      var v = JSON.stringify(inputValues());
      try { localStorage.setItem('comment-prefs', v); } catch (e) {}
    }, loadScript = function() {
      var full = a.classList.contains('comment-full');
      a.querySelectorAll('input[name="tabs"]').forEach(function(el, i) {
        if (!full && !el.checked) return;
        var p = a.querySelector('.panel:nth-of-type(' + (i + 1) + ') > script[data-src]');
        if (!p || !p.dataset.src) return;
        p.src = p.dataset.src;
        p.removeAttribute('data-src');
      });
    };
    
    inputRestore();
    
    rads.forEach(function(el) { el.addEventListener('change', inputSave); });
    var b = false, l = function(scroll) {
      if (b) return;
      a.querySelector('.tabs').style.display = '';
      loadScript();
      b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      
      var s2 = d.createElement('script');
      s2.src = "//cdn.jsdelivr.net/gh/yihui/DisqusJS@1.3.3/src/disqus.min.js";
      t.appendChild(s2);
      try { localStorage.setItem('dsqjs_mode', 'dsqjs'); } catch (e) {}
      s2.onload = function(e) {
        var s3 = d.createElement('link');
        s3.rel = 'stylesheet';
        s3.href = '//cdn.jsdelivr.net/gh/yihui/DisqusJS@1.3.3/src/disqusjs.min.css';
        d.head.appendChild(s3);
        disqus_config.DisqusJSInit();
      };
      s2.onerror = function(e) {
        t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in certain regions. If you are sure it is not blocked in your region, please refresh the page. Alternatively, you can comment with Utterances. 您可能需要翻墙发表 Disqus 评论；若没有梯子，不妨尝试使用 Github 登录 Utterances 评论。';
        t.style.border = '1px dashed';
        t.style.padding = '.5em';
        t.style.background = 'lightyellow';
        selectTab2();
      };
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = a.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })(document);
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>





<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>


  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© <a href="/">Jianbo Wang</a> 2010 - 2022</div>
  
  </footer>
  </article>
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({startOnLoad: false});
    mermaid.init(undefined, '.language-mermaid');
  </script>
  </body>
</html>

